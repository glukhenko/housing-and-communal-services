1)Как подать команду на принтер?
Берем файл, к примеру test.pos (расширение не играет роли мб и txt и др.) записываем туда коды и в консоли посылаем команду
print /d:\\ИмяСервера\ИмяСетевогоПринтера test.pos
На момент создания программы рабочей была команда, где имя сервера Printserver и имя сетевого принтера NetMatrix:
т.е.
print /d:\\\\Printserver\NetMatrix test.pos

Если принтер доступен то принтер принимает коды (настройки)


2) Работа с штрих кодами
чтоб на принтере печатался штрих код. Необходимо установить формат штрих кода (1-ая команда) и послать данные для печати штрих кода (2-я команда)

Устанавливать формат штрих кода следует, если выключали принтер, если выключался свет, или перепрограмировался. Кароче если не печатаются данные штрих кода то следует выполнить первую команду по установке штрих кода

Код для установки формата штрих кода: (google -> select bar code type and size command)
27 16 65 8 4 0 0 6 1 1 1 2   ps тут и далее код вводится не через пробел, для данного кода нужно 27166584006....
Причем код 0 установить придется иными программами (я делал через winhex12sr9)
В данной последовательности устанавливается Code 128, размеры штрих кода и др. параметры (см. гугл)

Код для отправки данных штрих кода (аля печать штрих кода):
27 16 66 p1 n _ data
где p1 - длина даты, к примеру data = 3145 то p1 = 4
У меня в программе стоит значение 34 для p1 (где 32 под данные, 1 для stop символа, 1 для пробела разделяющего 271666p1n и data)
n - мод для Code C (65 для mode A, 66 для mode B, 67 для mode C) PS: использовал всегда mode C (т.к. в данном формате предоставляют инари)

3) ПРО формирование программой штрих кода.
Поскольку штрих код имеет постоянную длину данных (30 символов), то достаточно лишь установить какая метка будет отвечать за данные штрих кода
и установить метку в словаре.
В разработанной программе используется метка 22 с данными barcode, т.е. выглядит следующим образом:
M22=barcode
PS не важно какое слово, поставить главное чтоб отлично от нуля (ну и после первого прогона метка встанет в M22=barcode, даже если изначально вы поставили M22=myBarCode бла бла бла )


4) коды для увеличения размера шрифта:
печать увеличенного текста происходит в 3 этапа. Неоходимо включать увеличение и выключать увеличение шрифта и после устанавливать настройки ширины печати (и др)
К примеру необходимо:   квитанция выдана АККОРД управляющая компания
При увеличении слова аккорд необходимо обрамить это слово, а именно
квитанция выдана <code start> АККОРД <code finish> <code width> управляющая компания

1 этап:
Чтобы начать печатать большим шрифтом (code start):
код состоит из трех составляющих но в метку я объединяю
18 14
27 71
27 58
После этой последовательности шрифт большой
В метке через пробел устанавливаю 18 14 _ 27 71 _ 27 58

2 этап
Чтобы выключить режим печати большого шрифта
код состоит из двух частей, но в метке так же объединяю
27 72
15 
После этой последовательности шрифт стандартный
В метке через пробел устанавливаю 27 72 _ 15

3 этап
Состоит из четырех коменд, в метке я объединяю
27 88 2 153 _ 27 65 6 _ 27 50 _ 27 86
PS 2 - левая колонка с которой начать печать
153 - правая колонка которой заканчивать строку

ВСЕ всего лишь, так просто расспечатать большой шрифт :)


